<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">

    <!-- 조건문 -->
	<sql id="where">
		<where>
		<if test="searchText != ''">
			<if test="searchType == 'ALL'">
			SUBJECT LIKE CONCAT('%',#{searchText},'%') OR WRITER LIKE CONCAT('%',#{searchText},'%') OR CONTENTS LIKE CONCAT('%',#{searchText},'%')
			</if>
			<if test="searchType == 'SUBJECT'">
			SUBJECT LIKE CONCAT('%',#{searchText},'%')
			</if>
			<if test="searchType == 'WRITER'">
			WRITER LIKE CONCAT('%',#{searchText},'%')
			</if>
			<if test="searchType == 'CONTENTS'">
			CONTENTS LIKE CONCAT('%',#{searchText},'%')
			</if>
		</if> 
		</where>
	</sql>
    
	<!-- 게시판 목록 조회 -->
	<select id="selectList" parameterType="BoardModel" resultType="BoardModel">
		SELECT
			NUM
		   ,SUBJECT
		   ,WRITER
		   ,CONTENTS
		   ,IP
		   ,HIT
		   ,REG_DATE
		   ,MOD_DATE
		FROM
			BOARD
		<include refid="where"/>
		ORDER BY NUM DESC
		LIMIT #{startIndex}, #{listCount}
	</select>
	
	<!-- 게시판 수 조회 -->
	<select id="selectCount" parameterType="BoardModel" resultType="int">
		SELECT COUNT(NUM) FROM BOARD
		<include refid="where"/>
	</select>
</mapper>

